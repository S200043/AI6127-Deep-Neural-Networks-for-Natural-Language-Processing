python main.py --cuda --model Transformer --epochs 10 --emsize 512 --nhid 1024 --nlayers 6 --nhead 8 --save model_default.pt
| epoch   1 |   200/ 2983 batches | lr 20.00 | ms/batch 49.58 | loss 11.32 | ppl 82853.61
| epoch   1 |   400/ 2983 batches | lr 20.00 | ms/batch 46.68 | loss  9.46 | ppl 12791.59
| epoch   1 |   600/ 2983 batches | lr 20.00 | ms/batch 46.83 | loss  8.85 | ppl  6964.09
| epoch   1 |   800/ 2983 batches | lr 20.00 | ms/batch 48.70 | loss  8.67 | ppl  5845.01
| epoch   1 |  1000/ 2983 batches | lr 20.00 | ms/batch 46.82 | loss  8.67 | ppl  5807.07
| epoch   1 |  1200/ 2983 batches | lr 20.00 | ms/batch 46.69 | loss  8.64 | ppl  5654.54
| epoch   1 |  1400/ 2983 batches | lr 20.00 | ms/batch 45.61 | loss  8.47 | ppl  4751.24
| epoch   1 |  1600/ 2983 batches | lr 20.00 | ms/batch 45.64 | loss  8.62 | ppl  5525.34
| epoch   1 |  1800/ 2983 batches | lr 20.00 | ms/batch 46.95 | loss  8.60 | ppl  5450.87
| epoch   1 |  2000/ 2983 batches | lr 20.00 | ms/batch 45.88 | loss  8.48 | ppl  4825.30
| epoch   1 |  2200/ 2983 batches | lr 20.00 | ms/batch 46.80 | loss  8.38 | ppl  4339.58
| epoch   1 |  2400/ 2983 batches | lr 20.00 | ms/batch 46.48 | loss  8.31 | ppl  4055.80
| epoch   1 |  2600/ 2983 batches | lr 20.00 | ms/batch 46.47 | loss  8.38 | ppl  4347.63
| epoch   1 |  2800/ 2983 batches | lr 20.00 | ms/batch 45.57 | loss  8.44 | ppl  4621.20
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 145.90s | valid loss  8.90 | valid ppl  7300.77
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 2983 batches | lr 20.00 | ms/batch 47.42 | loss  8.37 | ppl  4308.73
| epoch   2 |   400/ 2983 batches | lr 20.00 | ms/batch 45.67 | loss  8.36 | ppl  4270.72
| epoch   2 |   600/ 2983 batches | lr 20.00 | ms/batch 47.24 | loss  8.32 | ppl  4100.17
| epoch   2 |   800/ 2983 batches | lr 20.00 | ms/batch 46.92 | loss  8.32 | ppl  4099.50
| epoch   2 |  1000/ 2983 batches | lr 20.00 | ms/batch 46.56 | loss  8.37 | ppl  4300.96
| epoch   2 |  1200/ 2983 batches | lr 20.00 | ms/batch 46.81 | loss  8.24 | ppl  3784.03
| epoch   2 |  1400/ 2983 batches | lr 20.00 | ms/batch 45.92 | loss  8.29 | ppl  3975.52
| epoch   2 |  1600/ 2983 batches | lr 20.00 | ms/batch 45.41 | loss  8.31 | ppl  4051.95
| epoch   2 |  1800/ 2983 batches | lr 20.00 | ms/batch 45.24 | loss  8.89 | ppl  7282.06
| epoch   2 |  2000/ 2983 batches | lr 20.00 | ms/batch 46.02 | loss  8.26 | ppl  3852.91
| epoch   2 |  2200/ 2983 batches | lr 20.00 | ms/batch 47.07 | loss  8.34 | ppl  4197.43
| epoch   2 |  2400/ 2983 batches | lr 20.00 | ms/batch 49.45 | loss  8.35 | ppl  4220.03
| epoch   2 |  2600/ 2983 batches | lr 20.00 | ms/batch 47.56 | loss  8.16 | ppl  3484.61
| epoch   2 |  2800/ 2983 batches | lr 20.00 | ms/batch 45.37 | loss  8.15 | ppl  3477.75
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 145.08s | valid loss  7.35 | valid ppl  1560.70
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 2983 batches | lr 20.00 | ms/batch 46.79 | loss  8.37 | ppl  4302.09
| epoch   3 |   400/ 2983 batches | lr 20.00 | ms/batch 45.54 | loss  8.77 | ppl  6459.76
| epoch   3 |   600/ 2983 batches | lr 20.00 | ms/batch 45.72 | loss  8.63 | ppl  5571.08
| epoch   3 |   800/ 2983 batches | lr 20.00 | ms/batch 47.84 | loss  8.40 | ppl  4439.66
| epoch   3 |  1000/ 2983 batches | lr 20.00 | ms/batch 49.88 | loss  8.24 | ppl  3773.68
| epoch   3 |  1200/ 2983 batches | lr 20.00 | ms/batch 47.06 | loss  8.16 | ppl  3508.87
| epoch   3 |  1400/ 2983 batches | lr 20.00 | ms/batch 45.86 | loss  7.81 | ppl  2455.68
| epoch   3 |  1600/ 2983 batches | lr 20.00 | ms/batch 49.55 | loss  7.71 | ppl  2232.65
| epoch   3 |  1800/ 2983 batches | lr 20.00 | ms/batch 51.19 | loss  7.70 | ppl  2211.26
| epoch   3 |  2000/ 2983 batches | lr 20.00 | ms/batch 46.12 | loss  7.69 | ppl  2183.68
| epoch   3 |  2200/ 2983 batches | lr 20.00 | ms/batch 48.73 | loss  7.68 | ppl  2172.62
| epoch   3 |  2400/ 2983 batches | lr 20.00 | ms/batch 45.91 | loss  7.63 | ppl  2055.25
| epoch   3 |  2600/ 2983 batches | lr 20.00 | ms/batch 47.69 | loss  7.65 | ppl  2109.28
| epoch   3 |  2800/ 2983 batches | lr 20.00 | ms/batch 47.27 | loss  7.64 | ppl  2087.13
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 147.93s | valid loss  7.57 | valid ppl  1943.88
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 2983 batches | lr 5.00 | ms/batch 44.05 | loss  7.09 | ppl  1201.90
| epoch   4 |   400/ 2983 batches | lr 5.00 | ms/batch 43.26 | loss  7.05 | ppl  1155.06
| epoch   4 |   600/ 2983 batches | lr 5.00 | ms/batch 43.76 | loss  7.04 | ppl  1140.89
| epoch   4 |   800/ 2983 batches | lr 5.00 | ms/batch 44.78 | loss  7.04 | ppl  1147.04
| epoch   4 |  1000/ 2983 batches | lr 5.00 | ms/batch 43.48 | loss  7.06 | ppl  1164.38
| epoch   4 |  1200/ 2983 batches | lr 5.00 | ms/batch 45.51 | loss  7.07 | ppl  1172.53
| epoch   4 |  1400/ 2983 batches | lr 5.00 | ms/batch 43.27 | loss  7.04 | ppl  1140.74
| epoch   4 |  1600/ 2983 batches | lr 5.00 | ms/batch 43.06 | loss  7.05 | ppl  1155.08
| epoch   4 |  1800/ 2983 batches | lr 5.00 | ms/batch 44.56 | loss  7.03 | ppl  1127.49
| epoch   4 |  2000/ 2983 batches | lr 5.00 | ms/batch 44.44 | loss  7.05 | ppl  1149.67
| epoch   4 |  2200/ 2983 batches | lr 5.00 | ms/batch 43.77 | loss  7.05 | ppl  1150.61
| epoch   4 |  2400/ 2983 batches | lr 5.00 | ms/batch 43.71 | loss  7.01 | ppl  1108.21
| epoch   4 |  2600/ 2983 batches | lr 5.00 | ms/batch 43.85 | loss  7.04 | ppl  1137.94
| epoch   4 |  2800/ 2983 batches | lr 5.00 | ms/batch 45.89 | loss  7.01 | ppl  1106.03
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 137.67s | valid loss  7.03 | valid ppl  1132.65
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 2983 batches | lr 5.00 | ms/batch 44.22 | loss  7.03 | ppl  1132.32
| epoch   5 |   400/ 2983 batches | lr 5.00 | ms/batch 44.04 | loss  7.01 | ppl  1107.78
| epoch   5 |   600/ 2983 batches | lr 5.00 | ms/batch 43.94 | loss  6.99 | ppl  1089.44
| epoch   5 |   800/ 2983 batches | lr 5.00 | ms/batch 44.81 | loss  7.00 | ppl  1098.63
| epoch   5 |  1000/ 2983 batches | lr 5.00 | ms/batch 43.90 | loss  7.02 | ppl  1121.56
| epoch   5 |  1200/ 2983 batches | lr 5.00 | ms/batch 43.54 | loss  7.03 | ppl  1132.24
| epoch   5 |  1400/ 2983 batches | lr 5.00 | ms/batch 43.58 | loss  7.00 | ppl  1101.53
| epoch   5 |  1600/ 2983 batches | lr 5.00 | ms/batch 43.92 | loss  7.02 | ppl  1114.04
| epoch   5 |  1800/ 2983 batches | lr 5.00 | ms/batch 44.61 | loss  6.99 | ppl  1089.75
| epoch   5 |  2000/ 2983 batches | lr 5.00 | ms/batch 44.29 | loss  7.01 | ppl  1109.93
| epoch   5 |  2200/ 2983 batches | lr 5.00 | ms/batch 44.84 | loss  7.01 | ppl  1111.83
| epoch   5 |  2400/ 2983 batches | lr 5.00 | ms/batch 44.29 | loss  6.97 | ppl  1067.10
| epoch   5 |  2600/ 2983 batches | lr 5.00 | ms/batch 43.52 | loss  7.00 | ppl  1098.00
| epoch   5 |  2800/ 2983 batches | lr 5.00 | ms/batch 43.26 | loss  6.97 | ppl  1064.35
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 137.37s | valid loss  7.07 | valid ppl  1178.07
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 2983 batches | lr 1.25 | ms/batch 42.82 | loss  6.97 | ppl  1065.80
| epoch   6 |   400/ 2983 batches | lr 1.25 | ms/batch 42.42 | loss  6.95 | ppl  1041.82
| epoch   6 |   600/ 2983 batches | lr 1.25 | ms/batch 43.44 | loss  6.93 | ppl  1020.22
| epoch   6 |   800/ 2983 batches | lr 1.25 | ms/batch 42.93 | loss  6.94 | ppl  1035.72
| epoch   6 |  1000/ 2983 batches | lr 1.25 | ms/batch 42.16 | loss  6.96 | ppl  1056.98
| epoch   6 |  1200/ 2983 batches | lr 1.25 | ms/batch 42.59 | loss  6.98 | ppl  1070.10
| epoch   6 |  1400/ 2983 batches | lr 1.25 | ms/batch 42.54 | loss  6.95 | ppl  1045.67
| epoch   6 |  1600/ 2983 batches | lr 1.25 | ms/batch 43.13 | loss  6.96 | ppl  1056.37
| epoch   6 |  1800/ 2983 batches | lr 1.25 | ms/batch 42.29 | loss  6.94 | ppl  1031.64
| epoch   6 |  2000/ 2983 batches | lr 1.25 | ms/batch 42.26 | loss  6.96 | ppl  1055.45
| epoch   6 |  2200/ 2983 batches | lr 1.25 | ms/batch 43.84 | loss  6.96 | ppl  1048.92
| epoch   6 |  2400/ 2983 batches | lr 1.25 | ms/batch 42.47 | loss  6.92 | ppl  1013.72
| epoch   6 |  2600/ 2983 batches | lr 1.25 | ms/batch 43.04 | loss  6.95 | ppl  1039.50
| epoch   6 |  2800/ 2983 batches | lr 1.25 | ms/batch 42.27 | loss  6.92 | ppl  1010.51
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 133.66s | valid loss  7.02 | valid ppl  1114.36
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 2983 batches | lr 1.25 | ms/batch 42.97 | loss  6.96 | ppl  1055.30
| epoch   7 |   400/ 2983 batches | lr 1.25 | ms/batch 45.11 | loss  6.94 | ppl  1030.14
| epoch   7 |   600/ 2983 batches | lr 1.25 | ms/batch 43.40 | loss  6.92 | ppl  1009.32
| epoch   7 |   800/ 2983 batches | lr 1.25 | ms/batch 42.81 | loss  6.93 | ppl  1024.04
| epoch   7 |  1000/ 2983 batches | lr 1.25 | ms/batch 42.75 | loss  6.95 | ppl  1044.72
| epoch   7 |  1200/ 2983 batches | lr 1.25 | ms/batch 42.20 | loss  6.97 | ppl  1059.43
| epoch   7 |  1400/ 2983 batches | lr 1.25 | ms/batch 42.61 | loss  6.94 | ppl  1034.68
| epoch   7 |  1600/ 2983 batches | lr 1.25 | ms/batch 42.28 | loss  6.95 | ppl  1044.14
| epoch   7 |  1800/ 2983 batches | lr 1.25 | ms/batch 42.52 | loss  6.93 | ppl  1020.42
| epoch   7 |  2000/ 2983 batches | lr 1.25 | ms/batch 43.04 | loss  6.95 | ppl  1042.39
| epoch   7 |  2200/ 2983 batches | lr 1.25 | ms/batch 44.15 | loss  6.94 | ppl  1035.07
| epoch   7 |  2400/ 2983 batches | lr 1.25 | ms/batch 43.67 | loss  6.91 | ppl   999.17
| epoch   7 |  2600/ 2983 batches | lr 1.25 | ms/batch 43.21 | loss  6.93 | ppl  1024.88
| epoch   7 |  2800/ 2983 batches | lr 1.25 | ms/batch 42.58 | loss  6.90 | ppl   995.21
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 134.95s | valid loss  7.07 | valid ppl  1177.78
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 2983 batches | lr 0.31 | ms/batch 43.31 | loss  7.01 | ppl  1109.20
| epoch   8 |   400/ 2983 batches | lr 0.31 | ms/batch 42.54 | loss  6.98 | ppl  1079.07
| epoch   8 |   600/ 2983 batches | lr 0.31 | ms/batch 42.65 | loss  6.98 | ppl  1073.72
| epoch   8 |   800/ 2983 batches | lr 0.31 | ms/batch 42.47 | loss  6.98 | ppl  1073.19
| epoch   8 |  1000/ 2983 batches | lr 0.31 | ms/batch 42.33 | loss  7.00 | ppl  1101.35
| epoch   8 |  1200/ 2983 batches | lr 0.31 | ms/batch 42.31 | loss  7.01 | ppl  1112.01
| epoch   8 |  1400/ 2983 batches | lr 0.31 | ms/batch 42.37 | loss  6.99 | ppl  1089.75
| epoch   8 |  1600/ 2983 batches | lr 0.31 | ms/batch 42.42 | loss  7.00 | ppl  1100.57
| epoch   8 |  1800/ 2983 batches | lr 0.31 | ms/batch 42.20 | loss  6.97 | ppl  1064.68
| epoch   8 |  2000/ 2983 batches | lr 0.31 | ms/batch 43.02 | loss  6.99 | ppl  1090.86
| epoch   8 |  2200/ 2983 batches | lr 0.31 | ms/batch 43.31 | loss  7.00 | ppl  1093.98
| epoch   8 |  2400/ 2983 batches | lr 0.31 | ms/batch 44.35 | loss  6.98 | ppl  1073.30
| epoch   8 |  2600/ 2983 batches | lr 0.31 | ms/batch 43.13 | loss  6.99 | ppl  1080.69
| epoch   8 |  2800/ 2983 batches | lr 0.31 | ms/batch 43.53 | loss  6.96 | ppl  1058.24
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 134.44s | valid loss  7.04 | valid ppl  1144.14
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 2983 batches | lr 0.08 | ms/batch 43.06 | loss  7.11 | ppl  1222.04
| epoch   9 |   400/ 2983 batches | lr 0.08 | ms/batch 43.52 | loss  7.09 | ppl  1194.71
| epoch   9 |   600/ 2983 batches | lr 0.08 | ms/batch 42.87 | loss  7.06 | ppl  1163.82
| epoch   9 |   800/ 2983 batches | lr 0.08 | ms/batch 43.62 | loss  7.07 | ppl  1171.95
| epoch   9 |  1000/ 2983 batches | lr 0.08 | ms/batch 44.04 | loss  7.07 | ppl  1180.18
| epoch   9 |  1200/ 2983 batches | lr 0.08 | ms/batch 43.35 | loss  7.09 | ppl  1196.52
| epoch   9 |  1400/ 2983 batches | lr 0.08 | ms/batch 45.97 | loss  7.06 | ppl  1166.46
| epoch   9 |  1600/ 2983 batches | lr 0.08 | ms/batch 43.84 | loss  7.09 | ppl  1202.08
| epoch   9 |  1800/ 2983 batches | lr 0.08 | ms/batch 43.19 | loss  7.05 | ppl  1150.66
| epoch   9 |  2000/ 2983 batches | lr 0.08 | ms/batch 43.25 | loss  7.06 | ppl  1169.79
| epoch   9 |  2200/ 2983 batches | lr 0.08 | ms/batch 43.51 | loss  7.08 | ppl  1185.23
| epoch   9 |  2400/ 2983 batches | lr 0.08 | ms/batch 43.51 | loss  7.06 | ppl  1161.04
| epoch   9 |  2600/ 2983 batches | lr 0.08 | ms/batch 43.60 | loss  7.07 | ppl  1175.64
| epoch   9 |  2800/ 2983 batches | lr 0.08 | ms/batch 42.62 | loss  7.02 | ppl  1122.87
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 135.99s | valid loss  6.90 | valid ppl   996.70
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 2983 batches | lr 0.08 | ms/batch 43.36 | loss  7.10 | ppl  1212.27
| epoch  10 |   400/ 2983 batches | lr 0.08 | ms/batch 43.25 | loss  7.07 | ppl  1171.63
| epoch  10 |   600/ 2983 batches | lr 0.08 | ms/batch 42.45 | loss  7.05 | ppl  1157.94
| epoch  10 |   800/ 2983 batches | lr 0.08 | ms/batch 42.75 | loss  7.06 | ppl  1163.45
| epoch  10 |  1000/ 2983 batches | lr 0.08 | ms/batch 42.92 | loss  7.07 | ppl  1170.50
| epoch  10 |  1200/ 2983 batches | lr 0.08 | ms/batch 43.00 | loss  7.08 | ppl  1191.32
| epoch  10 |  1400/ 2983 batches | lr 0.08 | ms/batch 44.91 | loss  7.06 | ppl  1163.32
| epoch  10 |  1600/ 2983 batches | lr 0.08 | ms/batch 44.45 | loss  7.09 | ppl  1195.31
| epoch  10 |  1800/ 2983 batches | lr 0.08 | ms/batch 42.88 | loss  7.04 | ppl  1144.86
| epoch  10 |  2000/ 2983 batches | lr 0.08 | ms/batch 43.89 | loss  7.06 | ppl  1163.48
| epoch  10 |  2200/ 2983 batches | lr 0.08 | ms/batch 44.64 | loss  7.07 | ppl  1181.42
| epoch  10 |  2400/ 2983 batches | lr 0.08 | ms/batch 44.07 | loss  7.05 | ppl  1157.94
| epoch  10 |  2600/ 2983 batches | lr 0.08 | ms/batch 45.20 | loss  7.07 | ppl  1173.25
| epoch  10 |  2800/ 2983 batches | lr 0.08 | ms/batch 44.42 | loss  7.03 | ppl  1124.68
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 137.48s | valid loss  6.90 | valid ppl   995.65
-----------------------------------------------------------------------------------------
=========================================================================================
| End of training | test loss  6.84 | test ppl   932.66
=========================================================================================
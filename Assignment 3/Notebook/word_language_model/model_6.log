python main.py --cuda --model Transformer --epochs 10 --emsize 512 --nhid 1024 --nlayers 6 --nhead 8 --label-smoothing 0.1 --save model_6.pt
| epoch   1 |   200/ 2983 batches | lr 0.00004 | ms/batch 193.86 | loss  7.35 | ppl  5977.47
| epoch   1 |   400/ 2983 batches | lr 0.00007 | ms/batch 191.98 | loss  6.29 | ppl  1490.22
| epoch   1 |   600/ 2983 batches | lr 0.00010 | ms/batch 183.93 | loss  5.87 | ppl  1163.25
| epoch   1 |   800/ 2983 batches | lr 0.00014 | ms/batch 186.40 | loss  5.92 | ppl   961.16
| epoch   1 |  1000/ 2983 batches | lr 0.00017 | ms/batch 184.00 | loss  5.64 | ppl   799.76
| epoch   1 |  1200/ 2983 batches | lr 0.00021 | ms/batch 185.89 | loss  5.45 | ppl   709.98
| epoch   1 |  1400/ 2983 batches | lr 0.00024 | ms/batch 184.25 | loss  4.62 | ppl   257.80
| epoch   1 |  1600/ 2983 batches | lr 0.00028 | ms/batch 186.00 | loss  3.71 | ppl   100.20
| epoch   1 |  1800/ 2983 batches | lr 0.00031 | ms/batch 185.83 | loss  3.53 | ppl    80.80
| epoch   1 |  2000/ 2983 batches | lr 0.00035 | ms/batch 186.20 | loss  2.88 | ppl    35.90
| epoch   1 |  2200/ 2983 batches | lr 0.00038 | ms/batch 182.87 | loss  2.51 | ppl    21.77
| epoch   1 |  2400/ 2983 batches | lr 0.00042 | ms/batch 184.70 | loss  2.39 | ppl    17.59
| epoch   1 |  2600/ 2983 batches | lr 0.00045 | ms/batch 186.01 | loss  2.04 | ppl    11.85
| epoch   1 |  2800/ 2983 batches | lr 0.00049 | ms/batch 186.58 | loss  1.73 | ppl     8.27
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 576.34s | valid loss  1.61 | valid ppl     7.89
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 2983 batches | lr 0.00056 | ms/batch 186.99 | loss  1.66 | ppl     8.99
| epoch   2 |   400/ 2983 batches | lr 0.00059 | ms/batch 183.41 | loss  1.72 | ppl     8.24
| epoch   2 |   600/ 2983 batches | lr 0.00063 | ms/batch 185.63 | loss  1.52 | ppl     9.17
| epoch   2 |   800/ 2983 batches | lr 0.00066 | ms/batch 185.64 | loss  1.77 | ppl     8.43
| epoch   2 |  1000/ 2983 batches | lr 0.00070 | ms/batch 184.68 | loss  1.62 | ppl     8.61
| epoch   2 |  1200/ 2983 batches | lr 0.00068 | ms/batch 188.26 | loss  1.53 | ppl     8.63
| epoch   2 |  1400/ 2983 batches | lr 0.00067 | ms/batch 185.08 | loss  1.60 | ppl     9.47
| epoch   2 |  1600/ 2983 batches | lr 0.00065 | ms/batch 186.70 | loss  1.24 | ppl     8.02
| epoch   2 |  1800/ 2983 batches | lr 0.00064 | ms/batch 189.86 | loss  1.22 | ppl     8.14
| epoch   2 |  2000/ 2983 batches | lr 0.00063 | ms/batch 186.91 | loss  1.21 | ppl     6.58
| epoch   2 |  2200/ 2983 batches | lr 0.00061 | ms/batch 189.54 | loss  1.14 | ppl     5.29
| epoch   2 |  2400/ 2983 batches | lr 0.00060 | ms/batch 187.91 | loss  1.30 | ppl     5.65
| epoch   2 |  2600/ 2983 batches | lr 0.00059 | ms/batch 185.03 | loss  1.14 | ppl     4.53
| epoch   2 |  2800/ 2983 batches | lr 0.00058 | ms/batch 184.86 | loss  1.10 | ppl     4.39
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 576.22s | valid loss  1.02 | valid ppl     4.82
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 2983 batches | lr 0.00056 | ms/batch 191.99 | loss  1.04 | ppl     5.03
| epoch   3 |   400/ 2983 batches | lr 0.00055 | ms/batch 187.54 | loss  1.25 | ppl     5.29
| epoch   3 |   600/ 2983 batches | lr 0.00055 | ms/batch 187.48 | loss  1.08 | ppl     6.20
| epoch   3 |   800/ 2983 batches | lr 0.00054 | ms/batch 186.95 | loss  1.18 | ppl     4.48
| epoch   3 |  1000/ 2983 batches | lr 0.00053 | ms/batch 185.23 | loss  1.06 | ppl     4.65
| epoch   3 |  1200/ 2983 batches | lr 0.00052 | ms/batch 185.81 | loss  1.23 | ppl     6.37
| epoch   3 |  1400/ 2983 batches | lr 0.00051 | ms/batch 184.87 | loss  1.33 | ppl     6.70
| epoch   3 |  1600/ 2983 batches | lr 0.00051 | ms/batch 186.29 | loss  0.97 | ppl     5.29
| epoch   3 |  1800/ 2983 batches | lr 0.00050 | ms/batch 185.13 | loss  1.07 | ppl     5.91
| epoch   3 |  2000/ 2983 batches | lr 0.00050 | ms/batch 187.84 | loss  1.11 | ppl     5.75
| epoch   3 |  2200/ 2983 batches | lr 0.00049 | ms/batch 213.50 | loss  1.01 | ppl     4.41
| epoch   3 |  2400/ 2983 batches | lr 0.00048 | ms/batch 194.38 | loss  1.12 | ppl     4.53
| epoch   3 |  2600/ 2983 batches | lr 0.00048 | ms/batch 186.87 | loss  0.90 | ppl     3.51
| epoch   3 |  2800/ 2983 batches | lr 0.00047 | ms/batch 203.65 | loss  0.93 | ppl     3.62
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 587.94s | valid loss  0.92 | valid ppl     4.29
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 2983 batches | lr 0.00046 | ms/batch 194.44 | loss  0.89 | ppl     4.38
| epoch   4 |   400/ 2983 batches | lr 0.00046 | ms/batch 199.50 | loss  1.10 | ppl     4.37
| epoch   4 |   600/ 2983 batches | lr 0.00045 | ms/batch 195.63 | loss  0.97 | ppl     5.75
| epoch   4 |   800/ 2983 batches | lr 0.00045 | ms/batch 227.02 | loss  1.14 | ppl     4.38
| epoch   4 |  1000/ 2983 batches | lr 0.00044 | ms/batch 192.01 | loss  1.02 | ppl     4.81
| epoch   4 |  1200/ 2983 batches | lr 0.00044 | ms/batch 187.58 | loss  1.08 | ppl     5.77
| epoch   4 |  1400/ 2983 batches | lr 0.00043 | ms/batch 186.16 | loss  1.22 | ppl     6.13
| epoch   4 |  1600/ 2983 batches | lr 0.00043 | ms/batch 187.33 | loss  0.87 | ppl     5.04
| epoch   4 |  1800/ 2983 batches | lr 0.00043 | ms/batch 185.77 | loss  0.96 | ppl     5.76
| epoch   4 |  2000/ 2983 batches | lr 0.00042 | ms/batch 221.78 | loss  1.00 | ppl     5.23
| epoch   4 |  2200/ 2983 batches | lr 0.00042 | ms/batch 196.69 | loss  0.92 | ppl     4.06
| epoch   4 |  2400/ 2983 batches | lr 0.00041 | ms/batch 207.66 | loss  1.09 | ppl     4.38
| epoch   4 |  2600/ 2983 batches | lr 0.00041 | ms/batch 206.42 | loss  0.89 | ppl     3.48
| epoch   4 |  2800/ 2983 batches | lr 0.00041 | ms/batch 185.05 | loss  0.83 | ppl     3.23
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 609.05s | valid loss  0.86 | valid ppl     4.07
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 2983 batches | lr 0.00040 | ms/batch 186.79 | loss  0.84 | ppl     4.30
| epoch   5 |   400/ 2983 batches | lr 0.00040 | ms/batch 185.78 | loss  1.05 | ppl     4.24
| epoch   5 |   600/ 2983 batches | lr 0.00039 | ms/batch 184.57 | loss  0.91 | ppl     5.60
| epoch   5 |   800/ 2983 batches | lr 0.00039 | ms/batch 183.93 | loss  0.99 | ppl     3.75
| epoch   5 |  1000/ 2983 batches | lr 0.00039 | ms/batch 184.20 | loss  0.94 | ppl     4.47
| epoch   5 |  1200/ 2983 batches | lr 0.00039 | ms/batch 184.68 | loss  1.10 | ppl     5.93
| epoch   5 |  1400/ 2983 batches | lr 0.00038 | ms/batch 184.26 | loss  1.06 | ppl     5.19
| epoch   5 |  1600/ 2983 batches | lr 0.00038 | ms/batch 185.55 | loss  0.86 | ppl     4.98
| epoch   5 |  1800/ 2983 batches | lr 0.00038 | ms/batch 185.25 | loss  0.93 | ppl     5.55
| epoch   5 |  2000/ 2983 batches | lr 0.00037 | ms/batch 186.36 | loss  0.90 | ppl     4.55
| epoch   5 |  2200/ 2983 batches | lr 0.00037 | ms/batch 185.34 | loss  0.87 | ppl     3.86
| epoch   5 |  2400/ 2983 batches | lr 0.00037 | ms/batch 184.55 | loss  0.97 | ppl     3.86
| epoch   5 |  2600/ 2983 batches | lr 0.00037 | ms/batch 187.08 | loss  0.83 | ppl     3.23
| epoch   5 |  2800/ 2983 batches | lr 0.00036 | ms/batch 202.30 | loss  0.84 | ppl     3.23
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 581.92s | valid loss  0.83 | valid ppl     4.01
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 2983 batches | lr 0.00036 | ms/batch 207.94 | loss  0.86 | ppl     4.50
| epoch   6 |   400/ 2983 batches | lr 0.00036 | ms/batch 185.47 | loss  1.02 | ppl     4.12
| epoch   6 |   600/ 2983 batches | lr 0.00035 | ms/batch 189.09 | loss  0.96 | ppl     5.74
| epoch   6 |   800/ 2983 batches | lr 0.00035 | ms/batch 185.66 | loss  1.01 | ppl     3.83
| epoch   6 |  1000/ 2983 batches | lr 0.00035 | ms/batch 185.61 | loss  0.91 | ppl     4.31
| epoch   6 |  1200/ 2983 batches | lr 0.00035 | ms/batch 183.30 | loss  0.99 | ppl     5.46
| epoch   6 |  1400/ 2983 batches | lr 0.00035 | ms/batch 184.78 | loss  1.08 | ppl     5.51
| epoch   6 |  1600/ 2983 batches | lr 0.00034 | ms/batch 184.14 | loss  0.83 | ppl     5.00
| epoch   6 |  1800/ 2983 batches | lr 0.00034 | ms/batch 186.42 | loss  0.91 | ppl     5.75
| epoch   6 |  2000/ 2983 batches | lr 0.00034 | ms/batch 183.73 | loss  0.88 | ppl     4.82
| epoch   6 |  2200/ 2983 batches | lr 0.00034 | ms/batch 186.14 | loss  0.80 | ppl     3.79
| epoch   6 |  2400/ 2983 batches | lr 0.00034 | ms/batch 188.12 | loss  0.99 | ppl     3.96
| epoch   6 |  2600/ 2983 batches | lr 0.00033 | ms/batch 184.77 | loss  0.87 | ppl     3.45
| epoch   6 |  2800/ 2983 batches | lr 0.00033 | ms/batch 186.23 | loss  0.84 | ppl     3.36
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 578.85s | valid loss  0.80 | valid ppl     3.96
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 2983 batches | lr 0.00033 | ms/batch 188.14 | loss  0.81 | ppl     4.45
| epoch   7 |   400/ 2983 batches | lr 0.00033 | ms/batch 183.89 | loss  0.94 | ppl     3.81
| epoch   7 |   600/ 2983 batches | lr 0.00032 | ms/batch 185.22 | loss  0.86 | ppl     5.56
| epoch   7 |   800/ 2983 batches | lr 0.00032 | ms/batch 184.48 | loss  0.94 | ppl     3.56
| epoch   7 |  1000/ 2983 batches | lr 0.00032 | ms/batch 184.05 | loss  0.89 | ppl     4.33
| epoch   7 |  1200/ 2983 batches | lr 0.00032 | ms/batch 184.17 | loss  1.01 | ppl     5.59
| epoch   7 |  1400/ 2983 batches | lr 0.00032 | ms/batch 184.68 | loss  1.04 | ppl     5.35
| epoch   7 |  1600/ 2983 batches | lr 0.00032 | ms/batch 186.85 | loss  0.81 | ppl     5.16
| epoch   7 |  1800/ 2983 batches | lr 0.00031 | ms/batch 185.49 | loss  0.85 | ppl     5.41
| epoch   7 |  2000/ 2983 batches | lr 0.00031 | ms/batch 184.08 | loss  0.84 | ppl     4.69
| epoch   7 |  2200/ 2983 batches | lr 0.00031 | ms/batch 185.71 | loss  0.83 | ppl     3.68
| epoch   7 |  2400/ 2983 batches | lr 0.00031 | ms/batch 184.89 | loss  0.90 | ppl     3.67
| epoch   7 |  2600/ 2983 batches | lr 0.00031 | ms/batch 189.79 | loss  0.80 | ppl     3.17
| epoch   7 |  2800/ 2983 batches | lr 0.00031 | ms/batch 189.50 | loss  0.81 | ppl     3.19
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 574.84s | valid loss  0.77 | valid ppl     3.89
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 2983 batches | lr 0.00030 | ms/batch 189.28 | loss  0.74 | ppl     4.04
| epoch   8 |   400/ 2983 batches | lr 0.00030 | ms/batch 185.62 | loss  0.95 | ppl     3.92
| epoch   8 |   600/ 2983 batches | lr 0.00030 | ms/batch 185.19 | loss  0.83 | ppl     5.61
| epoch   8 |   800/ 2983 batches | lr 0.00030 | ms/batch 186.97 | loss  0.89 | ppl     3.37
| epoch   8 |  1000/ 2983 batches | lr 0.00030 | ms/batch 185.89 | loss  0.87 | ppl     4.20
| epoch   8 |  1200/ 2983 batches | lr 0.00030 | ms/batch 186.44 | loss  0.91 | ppl     5.04
| epoch   8 |  1400/ 2983 batches | lr 0.00030 | ms/batch 186.09 | loss  0.98 | ppl     4.87
| epoch   8 |  1600/ 2983 batches | lr 0.00029 | ms/batch 186.74 | loss  0.76 | ppl     4.72
| epoch   8 |  1800/ 2983 batches | lr 0.00029 | ms/batch 186.52 | loss  0.84 | ppl     5.24
| epoch   8 |  2000/ 2983 batches | lr 0.00029 | ms/batch 191.27 | loss  0.77 | ppl     4.34
| epoch   8 |  2200/ 2983 batches | lr 0.00029 | ms/batch 195.85 | loss  0.81 | ppl     3.77
| epoch   8 |  2400/ 2983 batches | lr 0.00029 | ms/batch 196.65 | loss  0.89 | ppl     3.54
| epoch   8 |  2600/ 2983 batches | lr 0.00029 | ms/batch 195.51 | loss  0.81 | ppl     3.21
| epoch   8 |  2800/ 2983 batches | lr 0.00029 | ms/batch 194.45 | loss  0.75 | ppl     2.99
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 587.60s | valid loss  0.77 | valid ppl     3.80
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 2983 batches | lr 0.00028 | ms/batch 193.91 | loss  0.73 | ppl     4.04
| epoch   9 |   400/ 2983 batches | lr 0.00028 | ms/batch 195.11 | loss  0.87 | ppl     3.51
| epoch   9 |   600/ 2983 batches | lr 0.00028 | ms/batch 194.23 | loss  0.85 | ppl     5.75
| epoch   9 |   800/ 2983 batches | lr 0.00028 | ms/batch 199.18 | loss  0.86 | ppl     3.24
| epoch   9 |  1000/ 2983 batches | lr 0.00028 | ms/batch 197.71 | loss  0.78 | ppl     3.87
| epoch   9 |  1200/ 2983 batches | lr 0.00028 | ms/batch 193.88 | loss  0.88 | ppl     4.78
| epoch   9 |  1400/ 2983 batches | lr 0.00028 | ms/batch 196.43 | loss  0.95 | ppl     4.81
| epoch   9 |  1600/ 2983 batches | lr 0.00028 | ms/batch 194.92 | loss  0.72 | ppl     4.60
| epoch   9 |  1800/ 2983 batches | lr 0.00028 | ms/batch 198.35 | loss  0.83 | ppl     5.18
| epoch   9 |  2000/ 2983 batches | lr 0.00027 | ms/batch 199.37 | loss  0.77 | ppl     4.23
| epoch   9 |  2200/ 2983 batches | lr 0.00027 | ms/batch 196.34 | loss  0.76 | ppl     3.61
| epoch   9 |  2400/ 2983 batches | lr 0.00027 | ms/batch 196.30 | loss  0.87 | ppl     3.49
| epoch   9 |  2600/ 2983 batches | lr 0.00027 | ms/batch 194.27 | loss  0.85 | ppl     3.32
| epoch   9 |  2800/ 2983 batches | lr 0.00027 | ms/batch 199.96 | loss  0.69 | ppl     2.77
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 607.37s | valid loss  0.75 | valid ppl     3.67
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 2983 batches | lr 0.00027 | ms/batch 194.19 | loss  0.72 | ppl     3.93
| epoch  10 |   400/ 2983 batches | lr 0.00027 | ms/batch 193.53 | loss  0.85 | ppl     3.38
| epoch  10 |   600/ 2983 batches | lr 0.00027 | ms/batch 209.78 | loss  0.80 | ppl     5.16
| epoch  10 |   800/ 2983 batches | lr 0.00027 | ms/batch 196.68 | loss  0.92 | ppl     3.56
| epoch  10 |  1000/ 2983 batches | lr 0.00026 | ms/batch 201.33 | loss  0.81 | ppl     4.04
| epoch  10 |  1200/ 2983 batches | lr 0.00026 | ms/batch 216.61 | loss  0.91 | ppl     4.97
| epoch  10 |  1400/ 2983 batches | lr 0.00026 | ms/batch 230.71 | loss  0.95 | ppl     4.79
| epoch  10 |  1600/ 2983 batches | lr 0.00026 | ms/batch 189.66 | loss  0.71 | ppl     4.39
| epoch  10 |  1800/ 2983 batches | lr 0.00026 | ms/batch 190.80 | loss  0.81 | ppl     5.09
| epoch  10 |  2000/ 2983 batches | lr 0.00026 | ms/batch 190.73 | loss  0.79 | ppl     4.36
| epoch  10 |  2200/ 2983 batches | lr 0.00026 | ms/batch 191.57 | loss  0.83 | ppl     3.80
| epoch  10 |  2400/ 2983 batches | lr 0.00026 | ms/batch 193.81 | loss  0.86 | ppl     3.32
| epoch  10 |  2600/ 2983 batches | lr 0.00026 | ms/batch 188.40 | loss  0.77 | ppl     3.05
| epoch  10 |  2800/ 2983 batches | lr 0.00026 | ms/batch 191.95 | loss  0.70 | ppl     2.77
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 610.96s | valid loss  0.74 | valid ppl     3.67
-----------------------------------------------------------------------------------------
=========================================================================================
| End of training | test loss  0.70 | test ppl     3.58
=========================================================================================